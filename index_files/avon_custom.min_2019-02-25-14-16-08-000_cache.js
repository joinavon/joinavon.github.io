function avonUtilities(){}function CustomerSelectController($cookies,$rootScope,$scope,$sessionStorage,$timeout,customerSelectService){function _handleKeywordWatch(newname,oldname){if(""===oldname&&""!==newname)return!1;if(!($scope.pageLoad<1)){var keyword=$scope.searchedKeyword;keyword=void 0!==keyword?keyword.trim():void 0,void 0!==keyword&&keyword.length>2?(jQuery($scope.acInputSelector).addClass("cust-search-load-icon"),filterTextTimeout&&$timeout.cancel(filterTextTimeout),filterTextTimeout=$timeout(function(){if(void 0!==keyword&&keyword.length>=2){var isPresent=!1,largeCustList=$scope.largeCustomers,count=0;if(largeCustList?(_.each(largeCustList,function(custObj){custObj.Name.toLowerCase().indexOf(keyword.toLowerCase())>-1&&count++}),isPresent=count>0):isPresent=!1,isPresent)jQuery($scope.acInputSelector).removeClass("cust-search-load-icon");else{var inputCustomer=JSON.stringify({custProfile:{version:$scope.parentJson.custProfilelist_version,token:$cookies.user_activity,userId:$cookies.user_handle1,mrktCd:$cookies.mrktCd,langCd:$cookies.langCd,devKey:$cookies.widget_activity,acctNr:$cookies.user_handle1,repAcctNr:$cookies.user_handle1,custCmntTxt:keyword}});$scope.viewData.keyword=keyword,$scope.viewData.wsRequestUrl=$scope.parentJson.custProfilelist_ws,$scope.viewData.inputCustomer=inputCustomer,customerSelectService.getCustomerLargeList($scope.customerSelectType,$scope.viewData).then(function(data){if(data){var customerList=[],repData=[],lastName="",firstName="",customerData=[];data.custProfile&&(angular.forEach(data.custProfile.custProfileList,function(value,key){if(void 0===value.custId)lastName=angular.isUndefined(value.lastNm)?"":value.lastNm,firstName=angular.isUndefined(value.frstNm)?"":value.frstNm,repData.push({Id:value.custId,Name:firstName+" "+lastName,LastName:lastName});else{lastName=angular.isUndefined(value.lastNm)?"":value.lastNm,firstName=angular.isUndefined(value.frstNm)?"":value.frstNm;var name=$("<div/>").html(firstName+" "+lastName).text();customerList.push({Id:value.custId,Name:name.replace("'","'"),LastName:lastName})}}),customerList.sort(function(a,b){return a.Name.localeCompare(b.Name)}),angular.forEach(repData,function(val,key){customerData.push({Id:val.Id,Name:val.Name,LastName:val.LastName,value:val.Name})}),angular.forEach(customerList,function(val,key){customerData.push({Id:val.Id,Name:val.Name,LastName:val.LastName,value:val.Name})}),$scope.largeCustomerSearch?($scope.largeCustomers=customerData,$timeout(function(){$($scope.acInputSelector).autocomplete("clear"),$($scope.acInputSelector).autocomplete("setOptions",{lookup:$scope.largeCustomers}),$($scope.acInputSelector).autocomplete("onValueChange"),$scope.pageLoad++},100)):$scope.customers=customerData,1===customerData.length?$scope.nocustomers=!0:$scope.nocustomers=!1),jQuery($scope.acInputSelector).removeClass("cust-search-load-icon")}},function(err){console.log("Error getting large data :: ",err)})}}else $scope.largeCustomers=[]},250)):void 0!==keyword&&1===keyword.length&&($scope.largeCustomers=[],jQuery($scope.acInputSelector).removeClass("cust-search-load-icon"))}}function _updateCustomerList(){customerSelectService.getCustomerList($scope.customerSelectType,$scope.viewData).then(function(response){$scope.customerCount=response.customerCount,$scope.customerListData=response.customerListData,_populateCustomerList($scope.customerListData)})}function _constructItemTemplate(suggestion){return'<div class="item"><a href="javascript:void(0)"><div class="row"><div class="col col-xs-12"><p class="title m-0">'+suggestion.value+"</p></div></div></a></div>"}function _populateCustomerList(customerListData){var customerList=[],repData=[],lastName="",firstName="",customerData=[],data=angular.fromJson(customerListData);data.custProfile&&(angular.forEach(data.custProfile.custProfileList,function(value,key){void 0===value.custId?(lastName=angular.isUndefined(value.lastNm)?"":value.lastNm,firstName=angular.isUndefined(value.frstNm)?"":value.frstNm,repData.push({Id:value.custId,Name:firstName+" "+lastName,LastName:lastName})):(lastName=angular.isUndefined(value.lastNm)?"":value.lastNm,firstName=angular.isUndefined(value.frstNm)?"":value.frstNm,customerList.push({Id:value.custId,Name:firstName+" "+lastName,LastName:lastName}))}),customerList.sort(function(a,b){return a.Name.localeCompare(b.Name)}),angular.forEach(repData,function(val,key){customerData.push({Id:val.Id,Name:val.Name,LastName:val.LastName,value:val.Name})}),angular.forEach(customerList,function(val,key){customerData.push({Id:val.Id,Name:val.Name,LastName:val.LastName,value:val.Name})}),$scope.customersData=customerData,!$sessionStorage.customerDataLarge&&$scope.largeCustomerSearch&&($sessionStorage.customerDataLarge=customerData[0]),$sessionStorage.customerData||$scope.largeCustomerSearch||($sessionStorage.customerData=customerData[0]),_.delay(function(){$scope.isIE11?$timeout(function(){_constructAutoComplete()},500):_constructAutoComplete()},100))}function _constructAutoComplete(){var data,inputSelector;if($scope.largeCustomerSearch){var numItems=1;data=$scope.customersData.slice(0,numItems)}else if(data=$scope.customersData,$sessionStorage.customerData){var isCustomerDeleted=_.filter($scope.customersData,function(x){return x.Id==$sessionStorage.customerData.Id});0==isCustomerDeleted.length&&(delete $sessionStorage.customerData,$scope.$emit("updateCartCount",{update:!0}))}if(inputSelector=$scope.acInputSelector,_setCustomerSelectInputVal(),$scope.pageLoad<1){"item-entry"===$scope.customerSelectType&&_focusField(inputSelector,!1);var curCust=jQuery(".autocomplete-suggestions").find(".title:contains("+$scope.selectedCustomer.value+")");curCust.length&&curCust.click()}$scope.pageLoad++,$(inputSelector).autocomplete({lookup:data,onSelect:function(suggestion){switch($scope.selectedCustomer=suggestion,parentScope.selectedCustomer=suggestion,$scope.largeCustomerSearch?$sessionStorage.customerDataLarge=suggestion:$sessionStorage.customerData=suggestion,jQuery(inputSelector)[0].value=$scope.selectedCustomer.value,$scope.customerSelectType){case"item-entry":$scope.pageLoad>0&&_focusField("#item-entry-line-number",!1);break;case"pdp":jQuery("#noCustomerErr").hide();break;case"quick-shop":jQuery("#noCustomerErr").hide()}},formatResult:function(suggestion,RootVal){return _constructItemTemplate(suggestion)},onHide:function(){switch($(inputSelector)[0].value=$scope.selectedCustomer.value,jQuery(".customer-select-autocomplete").removeClass("autocomplete-open"),jQuery("body").removeClass("modal-open"),$scope.customerSelectType){case"item-entry":$timeout(function(){$scope.isIE11&&$scope.ie11Step<2?$scope.ie11Step++:_focusField("#item-entry-line-number",!1)},0)}$scope.autocompleteOpen=!1,$scope.$apply()},beforeRender:function(container,suggestions){switch(jQuery(".customer-select-autocomplete").addClass("autocomplete-open"),jQuery(window).width()<$scope.breakpoint&&jQuery("body").addClass("modal-open"),$scope.selectedCustomer.value.length?jQuery(".autocomplete-suggestions").find('.autocomplete-suggestion:contains("'+$scope.selectedCustomer.value+'")').addClass("selected"):jQuery(".autocomplete-suggestions").find(".autocomplete-suggestion:first").addClass("selected"),suggestions.length>=0?($scope.largeCustomerSearch?(jQuery(container).append('<div class="autocomplete-no-suggestion search-prompt"><p>'+$scope.customerSearchTxt+"</p></div>"),jQuery(container).append('<div class="autocomplete-spacer"></div><div class="autocomplete-suggestion-footer"><a id="autocomplete-add-customer-link" class="link-primary" data-toggle="modal" data-target="#add-new-customer-modal">'+$scope.addNewCustomerTxt+'<span class="lt-icon lt-plus lt-medium"></span></a></div>')):jQuery(container).append('<div class="autocomplete-spacer"></div><div class="autocomplete-suggestion-footer"><a id="autocomplete-add-customer-link" class="link-primary" data-toggle="modal" data-target="#add-new-customer-modal">'+$scope.addNewCustomerTxt+'<span class="lt-icon lt-plus lt-medium"></span></a></div>'),jQuery("#autocomplete-add-customer-link").on("click",function(e){e.preventDefault(),jQuery("#add-new-customer-modal").find("input[type=text]").val(""),$(inputSelector).autocomplete("hide"),jQuery(inputSelector).blur()})):jQuery(container).find(".autocomplete-suggestion:last-of-type").css("padding-bottom",0),setTimeout(function(){jQuery(document).trigger("newModalsAvailable")},0),$scope.customerSelectType){case"quick-shop":}$scope.autocompleteOpen=!0,$scope.$apply();var searchPrompt=jQuery(".autocomplete-suggestions").find(".search-prompt");$scope.largeCustomerSearch&&$scope.searchedKeyword&&($scope.searchedKeyword.length>=3?searchPrompt.addClass("d-none"):searchPrompt.removeClass("d-none")),$scope.isIE11&&$scope.ie11Step<1&&($scope.ie11Step++,$timeout(function(){$($scope.acInputSelector).autocomplete("hide")},0))},appendTo:jQuery(inputSelector).closest(".form-group"),width:jQuery(inputSelector).closest(".form-group").width(),showOnFocus:!0,minChars:0,maxHeight:jQuery(window).height(),showNoSuggestionNotice:!0,noSuggestionNotice:$scope.noSuggestionNotice,triggerSelectOnValidInput:!1,preserveInput:!0,autoSelectFirst:!0,tabDisabled:!0,zIndex:99})}function _focusField(field,clear){"#item-entry-line-number"===field&&(clear=!parentScope.isValidItem,$($scope.acInputSelector).autocomplete("hide")),jQuery(field).length&&(jQuery(field).focus(),clear?(jQuery(field)[0].value="",field===$scope.acInputSelector&&($scope.searchedKeyword="")):jQuery(field)[0].setSelectionRange(0,jQuery(field).val().length))}function _setCustomerSelectInputVal(){if(void 0!==$rootScope.lastAddedNewCustomer)if($scope.largeCustomerSearch){var customerProfile=JSON.parse($scope.customerListData),customerList=customerProfile.custProfile.custProfileList,newCustData=_.filter(customerList,function(customer){return customer.frstNm==$rootScope.lastAddedNewCustomer.firstName&&customer.lastNm==$rootScope.lastAddedNewCustomer.lastName}),newCust={Id:newCustData[0].custId,Name:newCustData[0].frstNm,LastName:newCustData[0].lastNm,value:newCustData[0].frstNm+" "+newCustData[0].lastNm};$sessionStorage.customerDataLarge=newCust,$timeout(function(){jQuery($scope.acInputSelector)[0].value=$sessionStorage.customerDataLarge.value,jQuery($scope.acInputSelector).blur(),$rootScope.lastAddedNewCustomer=void 0},100)}else $timeout(function(){jQuery($scope.acInputSelector).focus();var newCust=jQuery(".autocomplete-suggestions").find('.autocomplete-suggestion:contains("'+$rootScope.lastAddedNewCustomer.firstName+" "+$rootScope.lastAddedNewCustomer.lastName+'")');newCust.click(),jQuery($scope.acInputSelector).blur(),$rootScope.lastAddedNewCustomer=void 0},100);$scope.largeCustomerSearch?$sessionStorage.customerDataLarge?(parentScope.largeCustomerSearch=!0,$scope.selectedCustomer=parentScope.selectedCustomer=$sessionStorage.customerDataLarge,$scope.searchedKeyword=$sessionStorage.customerDataLarge.value,jQuery($scope.acInputSelector)[0].value=$scope.selectedCustomer.value):(parentScope.largeCustomerSearch=!1,$scope.selectedCustomer=$scope.customersData[0],jQuery($scope.acInputSelector)[0].value=$scope.selectedCustomer.value):$sessionStorage.customerData?($scope.selectedCustomer=parentScope.selectedCustomer=$sessionStorage.customerData,jQuery($scope.acInputSelector)[0].value=$scope.selectedCustomer.value):(jQuery($scope.acInputSelector)[0].value=$scope.customersData[0].value,$scope.selectedCustomer=parentScope.selectedCustomer=$scope.customersData[0]),$scope.$emit("customerInputSetEvent")}var filterTextTimeout,parentScope=$scope.$parent;$scope.addingNewCustomer=!1,$scope.breakpoint=768,$scope.viewData={},$scope.parentJson={},$scope.parentConfigJson={},$scope.customerSelectType="",$scope.acInputSelector="",$scope.noSuggestionNotice="",$scope.addNewCustomerTxt="",$scope.customerSearchTxt="",$scope.isIE11=!!window.MSInputMethodContext&&!!document.documentMode,$scope.ie11Step=0,$scope.$on("updateCustomerListEvent",function(e){$scope.addingNewCustomer=!1,_updateCustomerList()}),$scope.$on("setCustomerInputValEvent",function(e){_setCustomerSelectInputVal()}),$scope.$on("addedNewCustomer",function(event,data,enable){$scope.addingNewCustomer=!1,customerListJSON=data,_updateCustomerList()}),$scope.$on("hideCustomerSelectEvent",function(e){$scope.hideAutoComplete()}),$scope.$watch("searchedKeyword",_handleKeywordWatch),this.setTypeAndConstruct=function(type){switch($scope.customerSelectType=type,$sessionStorage.customerData&&($scope.selectedCustomer=parentScope.selectedCustomer=$sessionStorage.customerData,$scope.customerName=$sessionStorage.customerData.value),$sessionStorage.customerDataLarge&&($scope.selectedCustomer=parentScope.selectedCustomer=$sessionStorage.customerDataLarge,$scope.searchedKeyword=$sessionStorage.customerDataLarge.value),$scope.customerSelectType){case"item-entry":$scope.parentJson=itemEntryWsJson,$scope.parentConfigJson=parentScope.configurationJson,$scope.noSuggestionNotice=parentScope.manualEntryContentJson.noSuggestionNotice,$scope.addNewCustomerTxt=parentScope.manualEntryContentJson.addNewCustomer,$scope.customerSearchTxt=parentScope.manualEntryContentJson.customerSearch,$scope.viewData={label:parentScope.manualEntryContentJson.whoIsThis,inputId:"pdpCustomerSelect",inputLargeId:"pdpLargeCustomerSelect",placeholder:parentScope.manualEntryContentJson.searchBoxLbl,containerClasses:"col-xs-12 col-sm-4 item-entry-col",formGroupClasses:"",configJson:$scope.parentConfigJson};break;case"pdp":$scope.parentJson=pdpWsJson,$scope.parentConfigJson=gmDetailConfigJSON,$scope.noSuggestionNotice=parentScope.noSuggestionNotice,$scope.addNewCustomerTxt=parentScope.addNewCustomer,$scope.customerSearchTxt="Search to see results from your customer list.",$scope.viewData={label:generalContentJson.custDrop,inputId:"pdpCustomerSelect",inputLargeId:"pdpLargeCustomerSelect",placeholder:"Search",containerClasses:"pdp-customer-select col-xs-8 col-md-9 px-0 mb-0 mb-md-3 pb-3",formGroupClasses:"text-left col-xs-12 p-0 m-0",configJson:$scope.parentConfigJson};break;case"quick-shop":$scope.parentJson=pdpWsJson,$scope.parentConfigJson=gmDetailConfigJSON,$scope.noSuggestionNotice=generalContentJson.noSuggestionNotice,$scope.addNewCustomerTxt=generalContentJson.addNewCustomer,$scope.customerSearchTxt="Search to see results from your customer list.",$scope.viewData={label:generalContentJson.custDrop,inputId:"pdpCustomerSelect",inputLargeId:"pdpLargeCustomerSelect",placeholder:"Search",containerClasses:"pdp-customer-select col-xs-9 px-0 mt-3 mb-0 mb-md-3 pb-3",formGroupClasses:"text-left col-xs-12 p-0 m-0",configJson:$scope.parentConfigJson}}customerSelectService.getCustomerList($scope.customerSelectType,$scope.viewData).then(function(response){$scope.customerCount=response.customerCount,$scope.customerListData=response.customerListData;var largeCustomerLimit;$scope.parentConfigJson.largeCustomerLimit&&""!==$scope.parentConfigJson.largeCustomerLimit&&(largeCustomerLimit=parseInt($scope.parentConfigJson.largeCustomerLimit)),$scope.customerCount>=largeCustomerLimit?($scope.largeCustomerSearch=!0,parentScope.largeCustomerSearch=!0,$scope.acInputSelector="#"+$scope.viewData.inputLargeId):($scope.largeCustomerSearch=!1,parentScope.largeCustomerSearch=!1,$scope.acInputSelector="#"+$scope.viewData.inputId),_populateCustomerList($scope.prodDemo?$scope.customerListData:$scope.customerListData)})},$scope.handleCustDropdownClick=function(e){$timeout(function(){jQuery($scope.acInputSelector+".form-control-feedback").off(),_focusField($scope.acInputSelector,!0)})},$scope.handleCustInputClick=function(){1===$scope.pageLoad&&($scope.pageLoad++,jQuery($scope.acInputSelector).blur())},$scope.handleCustSelectFocus=function(){_focusField($scope.acInputSelector,!1)},$scope.hideAutoComplete=function(){$($scope.acInputSelector).autocomplete("hide"),jQuery($scope.acInputSelector).blur()}}$.noConflict();var app=angular.module("Avon",["ngAnimate","ngCookies","ngResource","ui.bootstrap","ui.grid","ui.grid.pagination","ngStorage","ngSanitize","angularUtils.directives.dirPagination","ui.validate","ngIdle","ngLocale","slick","ngMagnify","ngMaterial","720kb.socialshare","infinite-scroll"]);!function(){"use strict";angular.module("Avon").factory("avonServiceInterceptor",["$q","$rootScope","$injector","$log","$sessionStorage",function($q,$rootScope,$injector,$log,$sessionStorage){var numLoadings=0;return{request:function(config){if(config&&config.url&&config.url.indexOf("agws")!==-1){if(wsShippingFacilityCode&&""!=wsShippingFacilityCode&&($sessionStorage.wsShippingFacilityCode=wsShippingFacilityCode),config.data){var jsonObj="string"==typeof config.data?JSON.parse(config.data):config.data,nodeValue=jsonObj[Object.keys(jsonObj)[0].toString()];nodeValue.isAphrodite=!0,config.data="string"==typeof jsonObj?JSON.parse(jsonObj):jsonObj,$sessionStorage.wsShippingFacilityCode&&""!=$sessionStorage.wsShippingFacilityCode&&(nodeValue.wsShippingFacilityCode=$sessionStorage.wsShippingFacilityCode,config.data="string"==typeof jsonObj?JSON.parse(jsonObj):jsonObj)}$log.debug("config in interceptor is "+JSON.stringify(config));var separator=config.url.indexOf("?")==-1?"?":"&";config.url=config.url+separator+"noCache="+(new Date).getTime(),config.hasOwnProperty("showSpinner")&&(numLoadings++,$rootScope.$broadcast("ShowLoader"))}return config||$q.when(config)},response:function(response){if(response.config.hasOwnProperty("showSpinner")&&(--numLoadings||$rootScope.$broadcast("HideLoader")),response.data&&"object"==typeof response.data){var new_user_activity=_.pluck(response.data,"token");$log.debug("user_activity is "+new_user_activity),isSecureEnv?(eraseCookie("user_activity"),createCookie("user_activity",new_user_activity,1,!0)):(eraseCookie("user_activity"),createCookie("user_activity",new_user_activity,1,!1))}if(response.data&&"object"==typeof response.data){for(var errorcode=_.pluck(response.data,"code"),found=!1,err_code_arr=err_code_arr||[],i=0;i<err_code_arr.length;i++)if(err_code_arr[i]==errorcode){found=!0;break}found&&homeLink!=currentPageLink&&!is_auth_env&&(showErrorPage||(showErrorPage=!0,$("#timeoutModal").addClass("in"),$("body").append('<div class="modal-backdrop fade in"></div>'),$("#timeoutModal").show()))}return response||$q.when(response)},responseError:function(response){return response.config&&response.config.hasOwnProperty("showSpinner")&&(--numLoadings||$rootScope.$broadcast("HideLoader")),$q.reject(response)}}}]),angular.module("Avon").config(function($httpProvider,$logProvider){$httpProvider.interceptors.push("avonServiceInterceptor"),$logProvider.debugEnabled(!1)})}(),function(){"use strict";angular.module("Avon").directive("numbersOnly",function(){return{require:"ngModel",link:function(scope,element,attr,ngModelCtrl){function fromUser(text){if(text){var transformedInput=text.replace(/[^0-9-]/g,"");return transformedInput!==text&&(ngModelCtrl.$setViewValue(transformedInput),ngModelCtrl.$render()),transformedInput}}ngModelCtrl.$parsers.push(fromUser)}}}).directive("numbersOnly",function(){return{require:"ngModel",link:function(scope,element,attr,ngModelCtrl){function fromUser(text){if(text){var transformedInput=text.replace(/[^\d|\-+|\.+]/g,"");return transformedInput!==text&&(ngModelCtrl.$setViewValue(transformedInput),ngModelCtrl.$render()),transformedInput}}ngModelCtrl.$parsers.push(fromUser)}}}).directive("tooltipSpecial",["$tooltip",function($tooltip){return $tooltip("tooltipSpecial","tooltip","mouseenter")}]).directive("focus",function($timeout){return{scope:{trigger:"@focus"},link:function(scope,element){scope.$watch("trigger",function(value){"true"===value&&$timeout(function(){element[0].focus()})})}}}).directive("loader",function($log){return{restrict:"A",link:function($scope,element,attrs){$scope.$on("ShowLoader",function(e){$log.debug("show loader on element: "+JSON.stringify(element)),element.addClass("process-overlay")}),$scope.$on("HideLoader",function(e){$log.debug("hide loader on element : "+JSON.stringify(element)),element.removeClass("process-overlay")})}}}).directive("dynUrl",function(){return{templateUrl:function(tElement,tAttrs){return tAttrs.templateUrl}}}).directive("menuCollapse",function(){return{restrict:"A",link:function(scope,elem,attrs){elem.on("click",function(){$(this).parent().next(".collapse").toggleClass("in")})}}}).directive("scrollToFunctionalElement",function(){return{restrict:"A",link:function(scope,$elm,attr){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&$("body").animate({scrollTop:$("#jumpToTheContainer").offset().top},"slow")}}}).directive("withoutSpace",function(){return{restrict:"A",link:function(scope,$elm,attr){$elm.keyup(function(event){var newValue=$elm.val().replace(/[^0-9-]/g,"");$elm.val(newValue)})}}}).directive("marksorted",function(){return{link:function(scope,elem){elem.bind("click",function(){elem.parent().children().removeClass("sorted"),elem.addClass("sorted")})}}}).directive("avnSelect",function(){return{restrict:"E",scope:{action:"&",items:"=",selected:"="},templateUrl:function(elem,attrs){return attrs.templateUrl}}}).directive("avnHeader",function(){return{restrict:"E",scope:{},link:function(scope){scope.headerElem=headerJSON,scope.textTitle=text},templateUrl:function(elem,attrs){return attrs.templateUrl}}}).directive("sameColumnSize",function($timeout){return{restrict:"EA",scope:{extraWidth:"@",columnsMinSize:"@",extraWidthMinsize:"@",trigger:"="},link:function(scope,element,attr){var extraWidthMinsize=parseInt(scope.extraWidthMinsize);jQuery(".table-responsive table").css("visibility","hidden"),scope.resizeColumns=function(){var parentTable=element.find("table[columnParent]")[0];if("none"===jQuery(parentTable).css("display")){parentTable.removeAttribute("columnparent");var firstChild=element.find("table[columnchild]:not(.ng-hide)")[0];firstChild.removeAttribute("columnchild"),firstChild.setAttribute("columnParent","")}var offsetWidtArray=[];if(scope.extraWidth)var extraWidthOject=JSON.parse(scope.extraWidth.replace(/'/g,'"')),columnsMinSize=JSON.parse(scope.columnsMinSize.replace(/'/g,'"'));jQuery(".table-responsive table").css("visibility","hidden"),jQuery(".table-responsive table").css("table-layout","auto"),_.defer(function(){for(var thTable1=jQuery.makeArray(element[0].querySelectorAll("table[columnParent] th.header")),thTable2=jQuery.makeArray(element[0].querySelectorAll("table[columnChild]:not(.ng-hide)")),i=0;i<thTable1.length;i++)offsetWidtArray.push(thTable1[i].offsetWidth);for(var i=thTable2.length-1;i>=0;i--)for(var tableAux=jQuery.makeArray(thTable2[i].querySelectorAll("tr:not(.ng-hide):not(.ng-table-sort-header)")[0].querySelectorAll("td")),j=tableAux.length-1;j>=0;j--)if(thTable1[j]){var elementWidth,thId=thTable1[j].id;elementWidth=columnsMinSize&&columnsMinSize[thId]?offsetWidtArray[j]<columnsMinSize[thId]?columnsMinSize[thId]:offsetWidtArray[j]:offsetWidtArray[j]<extraWidthMinsize&&extraWidthOject&&extraWidthOject[thId]?offsetWidtArray[j]+extraWidthOject[thId]:offsetWidtArray[j],thTable1[j].style.width=elementWidth+"px",tableAux[j].style.width=elementWidth+"px"}jQuery(".table-responsive table").css("visibility",""),jQuery(".table-responsive table").css("table-layout","fixed")})},scope.$watch("trigger",function(newValue,oldValue){(newValue||oldValue)&&scope.resizeColumns()},!0)}}}).directive("avonCalendar",["$document","$locale",function($document,$locale){return{link:function(scope,element,attr){var locales={es:{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],MONTH:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],SHORTDAY:["dom.","lun.","mar.","mié.","jue.","vie.","sáb."],SHORTMONTH:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"(¤",negSuf:")",posPre:"¤",posSuf:""}]},id:"es-es",pluralCat:function(n){return n>=0&&n<=2&&2!=n?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}}};"es"===langSelected&&angular.copy(locales.es,$locale),scope.today=function(){var dateAMonthAgo=new Date;dateAMonthAgo.setMonth(dateAMonthAgo.getMonth()-1),scope.ctrl.dt=moment(dateAMonthAgo).format("MM/DD/YYYY"),scope.initialStartDate=scope.dt,scope.ctrl.dt2=moment(new Date).format("MM/DD/YYYY"),scope.initialEndDate=scope.dt2},scope.today(),scope.dtmax=new Date,scope.open1=function(){scope.popup1.opened=!0},scope.open2=function(){scope.popup2.opened=!1},scope.toggleMin=function(){var dateAYearAgo=new Date;dateAYearAgo.setFullYear(dateAYearAgo.getFullYear()-1),scope.minDate=scope.minDate?null:dateAYearAgo},scope.toggleMin(),scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),scope.opened=!0},scope.formats=["MM/dd/yyyy"],scope.format=scope.formats[0],scope.popup1={opened:!1},scope.popup2={opened:!1};var tomorrow=new Date;tomorrow.setDate(tomorrow.getDate()+1);var afterTomorrow=new Date;afterTomorrow.setDate(tomorrow.getDate()+2),scope.events=[{date:tomorrow,status:"full"},{date:afterTomorrow,status:"partially"}],scope.getDayClass=function(date,mode){if("day"===mode)for(var dayToCheck=new Date(date).setHours(0,0,0,0),i=0;i<scope.events.length;i++){var currentDay=new Date(scope.events[i].date).setHours(0,0,0,0);if(dayToCheck===currentDay)return scope.events[i].status}return""},scope.getDatetime=new Date}}}]).directive("dropDownDir",function(){return{link:function(scope,element,attr){element.on("click",function(e){e.stopPropagation()})}}}).directive("hideInWebView",function(){return{link:function(scope,element,attr){var userAgent=window.navigator.userAgent.toLowerCase(),safari=/safari/.test(userAgent),ios=/iphone|ipod|ipad/.test(userAgent),android=/android/.test(userAgent),wv=/wv/.test(userAgent);ios?safari||safari||element.hide():android&&wv&&element.hide()}}}).directive("printLink",function($timeout){return{restrict:"A",link:function(scope,element,attr){element.on("click",function(e){console.log("HELLO HELLO - Print link clicked");var expandBtn=angular.element(".expand-all");expandBtn.length?(console.log("we have expand button..."),expandBtn.trigger("click"),$timeout(function(){window.print()},500)):window.print()})}}}).filter("customCurrency",["$filter",function($filter){return function(amount,currencySymbol){var currency=$filter("currency");return amount<0?currency(amount,currencySymbol).replace("(","-").replace(")",""):currency(amount,currencySymbol)}}])}(),avonUtilities.doGomacCall=function(localConfig,globalConfig){return localConfig=!(!localConfig||"true"!=localConfig),localConfig&&globalConfig},function(){"use strict";angular.module("Avon").controller("avonController",["$scope","$cookies","avonUtilService","$log","$rootScope","$sessionStorage","Idle","$window",function($scope,$cookies,avonUtilService,$log,$rootScope,$sessionStorage,Idle,$window){var isloggedIn=avonUtilService.isUserLoggedIn();if($rootScope.input={search:""},angular.element($window).on("shown.bs.modal",function(e){/iPad|Mac/.test(navigator.userAgent)&&!window.MSStream?(angular.element(document.body).hasClass("modal-open")&&angular.element(document.body).removeClass("modal-open"),angular.element(e.target).css("overflow","scroll")):angular.element(document.body).hasClass("modal-open")||angular.element(document.body).addClass("modal-open"),angular.element(document.body).css("overflow","hidden")}),angular.element($window).on("hidden.bs.modal",function(e){angular.element(document.body).css("overflow","auto")}),$log.debug("islogged in "+isloggedIn),isloggedIn){var profileData=avonUtilService.validateRepProfileInfo(getRepInfoWsUrl,getRepInfoWsVersion);profileData.then(function(data){$rootScope.$broadcast("getRepInfoReceived",{name:"Avon"})}),avonUtilService.keepAliveSession(contextPath+"/avon/login/rest/keepalive"),$rootScope.searchItem=function(){void 0==$rootScope.input.search||""==$rootScope.input.search?$("#searchError").show():($("#searchError").hide(),$sessionStorage.searchDescription=$rootScope.input.search,location.href=redirectCtxPath+avnSearchJSON.link)},$rootScope.openCart=function(path){0==orderCount?$sessionStorage.setNoOrdersModal=!0:$sessionStorage.setNoOrdersModal=!1,location.href=redirectCtxPath+path},$rootScope.getSearchTerm=function(){void 0==$rootScope.input.search||""==$rootScope.input.search?$("#searchError").show():$("#searchError").hide()}}isloggedIn&&!isCookieDeleted&&(Idle.watch(),$scope.$on("IdleStart",function(){}),$scope.$on("IdleEnd",function(){}),$scope.$on("IdleTimeout",function(){Idle.unwatch(),$("#timeoutModal").addClass("in"),$("body").append('<div class="modal-backdrop fade in"></div>'),$("#timeoutModal").show()}),$scope.$on("Keepalive",function(){avonUtilService.keepAliveSession(contextPath+"/avon/login/rest/keepalive")}))}]),angular.module("Avon").factory("avonUtilService",["$cookies","$resource","$sessionStorage","$q","$log",function($cookies,$resource,$sessionStorage,$q,$log){var _cache,bust=(new Date).getTime();return{isUserLoggedIn:function(){return angular.isDefined($cookies.user_activity)&&!angular.equals($cookies.user_activity,null)&&!angular.equals($cookies.user_activity,"")},renewToken:function(endpointUrl,endpointVersion){var dfd=$q.defer(),heartBeatService=$resource(endpointUrl+"?bust="+bust,{},{save:{method:"POST",cache:!0}}),heartBeatReq={heartBeatReq:{devKey:$cookies.widget_activity,langCd:$cookies.langCd,mrktCd:$cookies.mrktCd,userId:$cookies.user_handle1,acctNr:$cookies.user_handle2,version:endpointVersion,token:$cookies.user_activity}};heartBeatService.save(heartBeatReq).$promise.then(function(data){if(_cache=data,dfd.resolve(data),$log.debug("heartBeatResp is "+JSON.stringify(data)),data.heartBeatResp&&data.heartBeatResp.success){var user_activity=data.heartBeatResp.token;isSecureEnv?createCookie("user_activity",user_activity,1,!0):createCookie("user_activity",user_activity,1,!1)}},function(reason){dfd.reject("error in calling heartBeat "+JSON.stringify(reason))})},keepAliveSession:function(endpointUrl){var dfd=$q.defer(),keepAliveService=$resource(endpointUrl+"?bust="+bust,{},{save:{method:"GET",cache:!0}});keepAliveService.get().$promise.then(function(data){_cache=data,dfd.resolve(data),isSecureEnv?createCookie("user_activity",data.token,1,!0):createCookie("user_activity",data.token,1,!1),$log.debug("keepAliveService is "+JSON.stringify(data))},function(reason){dfd.reject("error in calling keepAliveService "+JSON.stringify(reason))})},validateRepProfileInfo:function(endpointUrl,endpointVersion){var dfd=$q.defer(),repData=$sessionStorage.getRepInfo;return angular.isUndefined(repData)||angular.equals(repData,null)?this.getRepProfile(endpointUrl,endpointVersion).then(function(data){$sessionStorage.getRepInfo=data,repData=$sessionStorage.getRepInfo,$sessionStorage.shpngFcltyCd=repData.profile.data.shpngFcltyCd,dfd.resolve(data)}):angular.equals($cookies.user_handle1,repData.profile.data.acctNr+"")?(void 0==$sessionStorage.shpngFcltyCd&&($sessionStorage.shpngFcltyCd=repData.profile.data.shpngFcltyCd),dfd.resolve(repData)):(this.logCollisionData(baseUrl+"/logging/logCollisionData","1"),this.getRepProfile(endpointUrl,endpointVersion).then(function(data){$sessionStorage.getRepInfo=data,repData=$sessionStorage.getRepInfo,$sessionStorage.shpngFcltyCd=repData.profile.data.shpngFcltyCd,dfd.resolve(data)})),dfd.promise},getRepProfile:function(endpointUrl,endpointVersion){var dfd=$q.defer();if(angular.isDefined(_cache)&&!angular.equals(_cache,null))dfd.resolve(_cache);else{var getRepProfileRes=$resource(endpointUrl+"?bust="+bust,{},{save:{method:"POST",cache:!0}}),getRepProfileReq={profile:{userId:$cookies.user_handle1,mrktCd:$cookies.mrktCd,
acctNr:$cookies.user_handle2,token:$cookies.user_activity,devKey:$cookies.widget_activity,langCd:$cookies.langCd,version:endpointVersion}};getRepProfileRes.save(getRepProfileReq).$promise.then(function(data){_cache=data,dfd.resolve(data)},function(reason){dfd.reject("error in getting rep data "+JSON.stringify(reason))})}return dfd.promise},logCollisionData:function(endpointUrl,endpointVersion){var dfd=$q.defer(),logCollisionDataRes=$resource(endpointUrl+"?bust="+bust,{},{save:{method:"POST",cache:!0}}),logCollisionDataReq={logMsg:{userId:$cookies.user_handle1,mrktCd:$cookies.mrktCd,acctNr:$cookies.user_handle2,token:$cookies.user_activity,devKey:$cookies.widget_activity,langCd:$cookies.langCd,version:endpointVersion,jsonString:"log data writing"}};return logCollisionDataRes.save(logCollisionDataReq).$promise.then(function(data){dfd.resolve(data)},function(reason){dfd.reject("error in logging collision data "+JSON.stringify(reason))}),dfd.promise}}}]),angular.module("Avon").config(function(KeepaliveProvider,IdleProvider){KeepaliveProvider.interval(900),IdleProvider.idle(1620),IdleProvider.timeout(1620)}),angular.module("Avon").controller("ModalInstanceController",["$scope","$modalInstance",function($scope,$modalInstance){$scope.ok=function(){$modalInstance.close()},$scope.cancelModal=function(){$modalInstance.dismiss("cancel")}}]).controller("leftNavController",function($scope){$scope.submenu=!0}).controller("DatepickerCtrl",function($scope){$scope.today=function(){$scope.dt=new Date,$scope.dt2=new Date;var ddate=new Date,d2date=new Date;$scope.dd=ddate.setDate((new Date).getDate()-30),$scope.dd2=d2date.setDate((new Date).getDate())},$scope.dtmax=new Date,$scope.today(),$scope.open1=function(){$scope.popup1.opened=!0},$scope.open2=function(){$scope.popup2.opened=!1},$scope.toggleMin=function(){$scope.minDate=$scope.minDate?null:new Date},$scope.toggleMin(),$scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.dateOptions={formatYear:"yyyy",startingDay:1,showWeeks:!1},$scope.formats=["MM/dd/yyyy"],$scope.format=$scope.formats[0],$scope.getDatetime=new Date,$scope.popup1={opened:!1},$scope.popup2={opened:!1}}).controller("ModalInstanceCtrl",function($scope,$modalInstance){$scope.ok=function(){$modalInstance.close()},$scope.cancel=function(){$modalInstance.dismiss("cancel")}}).controller("PrintCtrl",function($scope,$element,$window){$scope.printDiv=function(divName){var printContents=document.getElementById(divName).innerHTML,popupWin=window.open("#/printWindow","_blank");popupWin.document.open(),popupWin.document.write('<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css"href="/.resources/avon-theme/css/avon_styles.min.css" /></head><body class="printPage"><div class="options"><a onclick="window.print()" class="print"><i class="fa fa-print"></i> Print</a><a class="icon-close" onclick="window.close()"><i class="fa fa-times"></i></a> \t\t\t\t</div>'+printContents+"</body></html>"),popupWin.document.close()}}).config(function($mdThemingProvider,$mdInkRippleProvider){$mdThemingProvider.disableTheming(),$mdInkRippleProvider.disableInkRipple()}).config(function($mdGestureProvider){$mdGestureProvider.skipClickHijack()})}(),app.controller("customerSelectController",CustomerSelectController),app.directive("customerSelect",function($document){return{scope:!0,controller:"customerSelectController",controllerAs:"customerSelectCtrl",bindToController:!0,templateUrl:function(el,attrs){var parent=$(el).parents("[customer-select-template-url]");return parent.attr("customer-select-template-url")},link:function(scope,el,attrs){angular.element(document).ready(function(){scope.customerSelectCtrl.setTypeAndConstruct(attrs.type),$document.bind("touchstart",function(e){el===e.target||el[0].contains(e.target)||scope.$broadcast("hideCustomerSelectEvent")})})}}}),app.factory("customerSelectService",function($http,$q,$cacheFactory,$cookies,$resource,$sessionStorage){function params(){return instance.params||{}}function getCustomerList(type,params){params.type=type,instance.deferred=$q.defer(),instance.params=params;var listData={},largeCustomerLimit=params.configJson.largeCustomerLimit;return null!=customerListJSON&&void 0!==customerListJSON&&Object.keys(customerListJSON).length>0?(listData.customerCount=customerListJSON.custProfile.custProfileList.length,listData.customerListData=angular.toJson(customerListJSON),instance.deferred.resolve(listData)):jQuery.isEmptyObject(customerListJSON)&&(listData.customerCount=parseInt(largeCustomerLimit),listData.customerListData=getLargeCustomerRepProfile(),instance.deferred.resolve(listData)),instance.deferred.promise}function getCustomerLargeList(type,params){params.type=type,instance.deferred=$q.defer(),instance.params=params;var reqUrl=params.wsRequestUrl;if(!(params.keyword.trim().length<3)){var getDetails=$resource(reqUrl,{},{save:{method:"POST"}});return getDetails.save(params.inputCustomer,function(data){instance.deferred.resolve(data)}),instance.deferred.promise}}function getLargeCustomerRepProfile(){var repInfo=$sessionStorage.getRepInfo.profile.data,tempCustProfile={custProfile:{custProfileList:[{success:!0,frstNm:repInfo.frstNm,lastNm:repInfo.lastNm,emailAddrTxt:repInfo.emailAddrTxt}]}};return angular.toJson(tempCustProfile)}var instance={deferred:null,params:null};return{getCustomerList:getCustomerList,getCustomerLargeList:getCustomerLargeList,params:params}});
//# sourceMappingURL=avon_custom.min.js.map
